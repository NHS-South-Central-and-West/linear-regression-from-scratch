{
  "hash": "fb10f335df30a60d7e0cc15ddcbf2759",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Linear Regression from Scratch\"\nsubtitle: \"Building a Simple Linear Model to Better Understand Regression Methods\"\nauthor: \"Paul Johnson\"\n---\n\n\n\n\n\n# The Fundamentals of Regression {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\nGet in Loser, We're **Fitting Lines to Data**\n\n## What is Regression? {.center}\n\n- Regression models predict an outcome variable from a set of predictors. This can take the form of straight lines fit through the data, to many non-linear generalisations [@gelman2021].\n- Regression can be used to describe the association between variables, estimate the effect that a treatment has on an outcome, or predict how an outcome will change in response to changes in the predictor variables.\n- It is the foundation for many advanced statistical methods, and it is one of the most important tools available to an analyst seeking to use a sample to make inferences or predictions about the population [@rowntree2018].\n- While powerful, the method itself is (relatively) simple, when boiled down to its component parts.\n\n## It's All About the (Co)Variance {.center}\n\n- It is possible to make predictions or estimate effects between quantities of interest by analysing how they vary, both independently and together.\n- The extent to which the predictor variable, $X$, and the outcome, $Y$, move together is called \"covariance\".\n  - A positive covariance indicates that the value of $Y$ increases when $X$ increases, and a negative covariance indicates that $Y$ decreases when $X$ decreases.\n- Regression fits a line through data that estimate how the outcome variable changes when the value of the predictor variable(s) change. Finding the line that does the most effective job of passing through the data helps describe the relationship between the variables, or predict the outcome from the predictors.\n- This doesn't sound like much, but it's a surprisingly powerful idea.\n\n## Fitting a Line Through Data {.center}\n\n- At it's most basic conceptual level, regression is just finding the line of best fit through the data. \n  - The complexity comes in the need to use precise, unbiased methods to find the \"best\" fit.\n- There are various \"estimators\" that can be used to fit a straight line to data, but the most common method is called ordinary least squares (OLS).\n- OLS finds the line of best fit by minimising the total distance between the line and all observed values. The distance between the line, which represents the model's fitted values (or the predicted value of $Y$ given $X$) and each observed value in the data is known as the residual.\n- All paths lead to minimising the residuals.\n\n## Visualising the Outcome Variance {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(x = exam_score)) +\n  geom_histogram(binwidth = 1) +\n  labs(x = \"Exam Score\", y = NULL)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/outcome-dist-1.png){width=1800}\n:::\n:::\n\n\n\n## Visualising the Outcome Variance {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |> filter(exam_score < 80)\n  \ndf |> \n  ggplot(aes(x = exam_score)) +\n  geom_histogram(binwidth = 1) +\n  labs(x = \"Exam Score\", y = NULL)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/filtered-outcome-dist-1.png){width=1800}\n:::\n:::\n\n\n\n## Visualising the Predictor Variance {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(x = hours_studied)) +\n  geom_histogram(binwidth = 1) +\n  labs(x = \"Hours Studied\", y = NULL)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/predictor-dist-1.png){width=1800}\n:::\n:::\n\n\n\n## Visualising their Covariance {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(x = hours_studied, y = exam_score)) +\n  geom_point(shape = 21, fill = \"white\", size = 1.5, stroke = 1) +\n  labs(x = \"Hours Studied\", y = \"Exam Score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/covariance-1.png){width=1800}\n:::\n:::\n\n\n\n## Fitting a Regression Line {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(x = hours_studied, y = exam_score)) +\n  geom_point(shape = 21, fill = \"white\", size = 1.5, stroke = 1) +\n  geom_smooth(\n    method = lm, se = FALSE, linewidth = 1, colour = \"#005EB8\"\n    ) +\n  labs(x = \"Hours Studied\", y = \"Exam Score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/regression-line-1.png){width=1800}\n:::\n:::\n\n\n\n## Finding the Line of \"Best Fit\" {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(exam_score ~ hours_studied, data = df)\n\ndf <-\n  df |> \n  mutate(\n    fitted = model$fitted.values, \n    residual = model$residuals\n    )\n\ndf |> \n  select(hours_studied, exam_score, fitted, residual) |> \n  janitor::clean_names(case = \"title\") |> \n  slice_sample(n = 10) |> \n  gt() |> \n  fmt_number(columns = c(Fitted, Residual), decimals = 2) |> \n  cols_align(align = \"center\", columns = everything())\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"jqarequnnt\" style=\"overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>html {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\n}\n\n#jqarequnnt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jqarequnnt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 0;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jqarequnnt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jqarequnnt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jqarequnnt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jqarequnnt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jqarequnnt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jqarequnnt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jqarequnnt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jqarequnnt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jqarequnnt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jqarequnnt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jqarequnnt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jqarequnnt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jqarequnnt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jqarequnnt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jqarequnnt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jqarequnnt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jqarequnnt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jqarequnnt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-left: 4px;\n  padding-right: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jqarequnnt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jqarequnnt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jqarequnnt .gt_left {\n  text-align: left;\n}\n\n#jqarequnnt .gt_center {\n  text-align: center;\n}\n\n#jqarequnnt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jqarequnnt .gt_font_normal {\n  font-weight: normal;\n}\n\n#jqarequnnt .gt_font_bold {\n  font-weight: bold;\n}\n\n#jqarequnnt .gt_font_italic {\n  font-style: italic;\n}\n\n#jqarequnnt .gt_super {\n  font-size: 65%;\n}\n\n#jqarequnnt .gt_two_val_uncert {\n  display: inline-block;\n  line-height: 1em;\n  text-align: right;\n  font-size: 60%;\n  vertical-align: -0.25em;\n  margin-left: 0.1em;\n}\n\n#jqarequnnt .gt_footnote_marks {\n  font-style: italic;\n  font-weight: normal;\n  font-size: 75%;\n  vertical-align: 0.4em;\n}\n\n#jqarequnnt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jqarequnnt .gt_slash_mark {\n  font-size: 0.7em;\n  line-height: 0.7em;\n  vertical-align: 0.15em;\n}\n\n#jqarequnnt .gt_fraction_numerator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: 0.45em;\n}\n\n#jqarequnnt .gt_fraction_denominator {\n  font-size: 0.6em;\n  line-height: 0.6em;\n  vertical-align: -0.05em;\n}\n</style>\n<table class=\"gt_table\">\n  \n  <thead class=\"gt_col_headings\">\n    <tr>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\">Hours Studied</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\">Exam Score</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\">Fitted</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\">Residual</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td class=\"gt_row gt_center\">13</td>\n<td class=\"gt_row gt_center\">64</td>\n<td class=\"gt_row gt_center\">65.03</td>\n<td class=\"gt_row gt_center\">&minus;1.03</td></tr>\n    <tr><td class=\"gt_row gt_center\">16</td>\n<td class=\"gt_row gt_center\">65</td>\n<td class=\"gt_row gt_center\">65.91</td>\n<td class=\"gt_row gt_center\">&minus;0.91</td></tr>\n    <tr><td class=\"gt_row gt_center\">22</td>\n<td class=\"gt_row gt_center\">65</td>\n<td class=\"gt_row gt_center\">67.66</td>\n<td class=\"gt_row gt_center\">&minus;2.66</td></tr>\n    <tr><td class=\"gt_row gt_center\">9</td>\n<td class=\"gt_row gt_center\">63</td>\n<td class=\"gt_row gt_center\">63.87</td>\n<td class=\"gt_row gt_center\">&minus;0.87</td></tr>\n    <tr><td class=\"gt_row gt_center\">14</td>\n<td class=\"gt_row gt_center\">67</td>\n<td class=\"gt_row gt_center\">65.33</td>\n<td class=\"gt_row gt_center\">1.67</td></tr>\n    <tr><td class=\"gt_row gt_center\">16</td>\n<td class=\"gt_row gt_center\">68</td>\n<td class=\"gt_row gt_center\">65.91</td>\n<td class=\"gt_row gt_center\">2.09</td></tr>\n    <tr><td class=\"gt_row gt_center\">16</td>\n<td class=\"gt_row gt_center\">68</td>\n<td class=\"gt_row gt_center\">65.91</td>\n<td class=\"gt_row gt_center\">2.09</td></tr>\n    <tr><td class=\"gt_row gt_center\">21</td>\n<td class=\"gt_row gt_center\">65</td>\n<td class=\"gt_row gt_center\">67.37</td>\n<td class=\"gt_row gt_center\">&minus;2.37</td></tr>\n    <tr><td class=\"gt_row gt_center\">20</td>\n<td class=\"gt_row gt_center\">65</td>\n<td class=\"gt_row gt_center\">67.08</td>\n<td class=\"gt_row gt_center\">&minus;2.08</td></tr>\n    <tr><td class=\"gt_row gt_center\">12</td>\n<td class=\"gt_row gt_center\">66</td>\n<td class=\"gt_row gt_center\">64.74</td>\n<td class=\"gt_row gt_center\">1.26</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Finding the Line of \"Best Fit\" {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  ggplot(aes(x = hours_studied, y = exam_score)) +\n  geom_segment(\n    aes(\n      x = hours_studied, y= fitted, \n      xend = hours_studied, yend = fitted + residual\n      ), \n    linewidth = 1, color = \"#ED8B00\"\n    ) +\n  geom_point(shape = 21, fill = \"white\", size = 1.5, stroke = 1) +\n  geom_line(\n    aes(x = hours_studied, y = fitted), \n    linewidth = 1, colour = \"#005EB8\"\n    ) +\n  labs(x = \"Hours Studied\", y = \"Exam Score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/residuals-1.png){width=1800}\n:::\n:::\n\n\n\n## Finding the Line of \"Best Fit\" {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  slice_sample(n = 10) |> \n  ggplot(aes(x = hours_studied, y = exam_score)) +\n  geom_segment(\n    aes(\n      x = hours_studied, y= fitted, \n      xend = hours_studied, yend = fitted + residual\n      ), \n    linewidth = 1, color = \"#ED8B00\"\n    ) +\n  geom_point(shape = 21, fill = \"white\", size = 1.5, stroke = 1) +\n  geom_line(\n    aes(x = hours_studied, y = fitted), \n    linewidth = 1, colour = \"#005EB8\"\n    ) +\n  labs(x = \"Hours Studied\", y = \"Exam Score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/residuals-sample-1.png){width=1800}\n:::\n:::\n\n\n\n## Finding the Line of \"Best Fit\" {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  slice_sample(n = 100) |> \n  ggplot(aes(x = hours_studied, y = exam_score)) +\n  geom_segment(\n    aes(\n      x = hours_studied, y= fitted, \n      xend = hours_studied, yend = fitted + residual\n      ), \n    linewidth = 1, color = \"#ED8B00\"\n    ) +\n  geom_point(shape = 21, fill = \"white\", size = 1.5, stroke = 1) +\n  geom_line(\n    aes(x = hours_studied, y = fitted), \n    linewidth = 1, colour = \"#005EB8\"\n    ) +\n  labs(x = \"Hours Studied\", y = \"Exam Score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/residuals-bigger-sample-1.png){width=1800}\n:::\n:::\n\n\n\n## Finding the Line of \"Best Fit\" {.center}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  ggplot(aes(x = hours_studied, y = exam_score)) +\n  geom_segment(\n    aes(\n      x = hours_studied, y= fitted, \n      xend = hours_studied, yend = fitted + residual\n      ), \n    linewidth = 1, color = \"#ED8B00\"\n    ) +\n  geom_point(shape = 21, fill = \"white\", size = 1.5, stroke = 1) +\n  geom_line(\n    aes(x = hours_studied, y = fitted), \n    linewidth = 1, colour = \"#005EB8\"\n    ) +\n  labs(x = \"Hours Studied\", y = \"Exam Score\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/residuals-full-sample-1.png){width=1800}\n:::\n:::\n\n\n\n## Minimising the Residuals {.center}\n\n- The least squares estimator takes the residual value of all of the regression's predictions, squares them, and then sums them to get a single value that captures how well the model fits to the data.\n  - Squaring the value of each residual ensures sure that all values are positive, so that they don't cancel each other out, and gives greater weight to larger residuals, making sure that the fitted line accounts for values that are far away from the mean. This value is known as the residual sum of squares (RSS). \n  - $\\text{RSS} = \\sum_{i=1}^n (y_i - (\\beta_0 + \\beta_1 x_i))^2$\n- Finding the line that minimises the RSS produces an unbiased linear estimator (assuming that the regression assumptions are all met), or the line of best fit!\n\n## Solve for $\\beta_0$ and $\\beta_1$; Minimise RSS {.center .smaller}\n\n- $\\text{Residual Sum of Squares (RSS)} = \\sum_{i=1}^n \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right)^2$\n\n- Minimising RSS gives us the line that best fits the data, but we don't know what $\\beta_0$ or $\\beta_1$ are!\n\n- Minimize RSS (Solve for $\\beta_0$, then $\\beta_1$)\n\n::::::{.columns}\n:::::{.column}\n\n\n  1. $\\frac{\\partial}{\\partial \\beta_0} \\text{RSS} = \\frac{\\partial}{\\partial \\beta_0} \\sum_{i=1}^n \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right)^2$\n  2. $\\frac{\\partial}{\\partial \\beta_0} \\text{RSS} = -2 \\sum_{i=1}^n \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right)$\n  3. $\\sum_{i=1}^n \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right) = 0$\n  4. $n \\beta_0 + \\beta_1 \\sum_{i=1}^n x_i = \\sum_{i=1}^n y_i$\n  5. $\\beta_0 = \\bar{y} - \\beta_1 \\bar{x}$\n\n:::::\n:::::{.column}\n  \n  1. $\\frac{\\partial}{\\partial \\beta_1} \\text{RSS} = \\frac{\\partial}{\\partial \\beta_1} \\sum_{i=1}^n \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right)^2$\n  2. $\\frac{\\partial}{\\partial \\beta_1} \\text{RSS} = -2 \\sum_{i=1}^n x_i \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right)$\n  3. $\\sum_{i=1}^n x_i \\left( y_i - (\\beta_0 + \\beta_1 x_i) \\right) = 0$\n  4. $\\beta_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2}$\n\n:::::\n::::::\n\n- Final Coefficients - $\\beta_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2} = \\frac{\\text{Cov}(X, Y)}{\\text{Var}(X)}$ ; $\\beta_0 = \\bar{y} - \\beta_1 \\bar{x}$\n\n\n# The Components of Simple Linear Regression {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\nOur good friends $\\beta_1$, $\\beta_0$, and $\\epsilon$.\n\n## The Most Perfect Little Equation {.center}\n\n- The formula for a simple linear regression model, predicting $Y$ with one predictor $X$, is as follows: \n\n$$Y = \\beta_0 + \\beta_1 X + \\epsilon$$\n\n- This breaks the problem down into three main components, and estimates two parameters:\n  - $\\beta_1$ - The slope, estimating the effect that $X$ has on the outcome, $Y$. \n  - $\\beta_0$ - The intercept, estimating the average value of $Y$ when $X = 0$.\n  - $\\epsilon$ - The error term (the unexplained variance), capturing the remaining variance in the outcome $Y$ that is not explained by the rest of the model.\n\n## Calculating the Regression Slope ($\\beta_1$) {.center}\n\n$$\\beta_1 = \\frac{\\text{Cov}(X, Y)}{\\text{Var}(X)} = \\frac{\\sum (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum (x_i - \\bar{x})^2} $$\n\n\n## Calculating the Regression Intercept ($\\beta_0$) {.center}\n\n$$\\beta_0 = \\bar{y} - \\beta_1 \\bar{x} $$\n\n## Predicting the Outcome ($\\hat{y}$) {.center}\n\n$$\\hat{y}_i = \\beta_0 + \\beta_1 x_i $$\n\n# Let's Write Some Code! {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\n# From Simple to Multiple Regression {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\nWhat Happens When We Add More Predictors?\n\n## It's Just a Regression With More Variables! {.center}\n\n$$Y = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + ... + \\beta_n X_n + \\epsilon$$\n\n# Wrapping Up {data-background-color=\"#425563\" data-verticator=\"#E8EDEE\"}\n\nWhere Next, Magic Math Man?\n\n## What We Haven't Covered {.center}\n\n- Model interpretation - Reading regression tables, understanding coefficients\n- Model evaluation - $R^2$, Root Mean Squared Error (RMSE)\n- Assumptions of linear regression - Linearity, independence, homoscedasticity, no multicollinearity\n- Model diagnostics\n\n## The Magic Was Within You All Along {.center}\n\n- At its heart, regression is relatively simple. It is just fitting a line of best fit to your data.\n- The component parts of a regression model fit together to estimate the explained variance (the intercept and slope), and the unexplained variance (the error term). This allows us to make predictions and quantify the uncertainty of those predictions.\n- Linear regression is not magic (even if it often feels that way). \n  - The magic comes from good theory, good data, and attention to detail (but mostly good theory).\n\n## Further Resources {.center}\n\n- MLU-Explain - [Linear Regression](https://mlu-explain.github.io/linear-regression/)\n- Jeremy Balka (jbstatistics) - [Simple Linear Regression](https://youtube.com/playlist?list=PLvxOuBpazmsND0vmkP1ECjTloiVz-pXla&si=kZcNgcWkb6E8170_)\n- Josh Starmer (StatQuest) - [Linear Regression and Linear Models](https://youtube.com/playlist?list=PLblh5JKOoLUIzaEkCLIUxQFjPIlapw8nU&si=rN7wtllmY0wAMbFa)\n- Jeremy Balka (jbstatistics) - [Deriving the Least Squares Estimators of the Slope and Intercept](https://youtu.be/ewnc1cXJmGA?si=MC3l-OC-9EZow2UF)\n- Andrew Gelman, Jennifer Hill, & Aki Vehtari - [Regression & Other Stories](https://users.aalto.fi/~ave/ROS.pdf)\n\n# Thank You!\n\nContact:\n<br>\n\n<ul >\n{{< fa solid envelope >}} [paul.johnson50@nhs.net](mailto: paul.johnson50@nhs.net)\n</ul>\n\n\nCode & Slides:\n<br>\n\n<ul >\n{{< fa brands github >}}[/NHS-South-Central-and-West/linear-regression-from-scratch](https://github.com/nhs-south-central-and-west/linear-regression-from-scratch)\n</ul>\n\n## References\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}